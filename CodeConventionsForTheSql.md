# Стиль кода SQL

<style>
.text-center {
  text-align: center;
}
</style>

1. Название базы данных пишется в PascalCase

| Плохо:                 | Хорошо:                      |
|------------------------|------------------------------|
| Forecast_Water_Balance | ForecastWaterBalance         |

2. Временный модификатор для названия базы пишется через подчёркивание _

| Плохо:                     | Хорошо:                      |
|----------------------------|------------------------------|
| ForecastWaterBalanceTests  | ForecastWaterBalance_Tests   |
| ForecastWaterBalanceBackup | ForecastWaterBalance_Backup  |

3. Название таблиц и других объектов базы данных (в том числе название столбцов) оформляется в snake_case

| Плохо:    | Хорошо:     |
|-----------|-------------|
| SystemLog |  system_log |

4. В базу добавляется таблица db_version для фиксация применений патчей для базы данных со следующей структурой:

| Поле          | Описание      | IS NULL     | Спецификации | Комментарий           |
|---------------|---------------|-------------|--------------|-----------------------|
| id            | int           | not null    | PK           | идентификатор строки  |
| major         | int           | not null    |              | major-версия базы     |
| minor         | int           | not null    |              | minor-версия базы     |
| patch         | int           | not null    |              | патч-версия базы      |
| meta          | nvarchar(50)  | null        |              | автор(ы) патча        |
| comment       | nvarchar(250) | null        |              | краткий комментарий   |
| change_date   | timestamp     | not null    |              | дата применения патча |

5. Если принято решение по продукту хранить системные и/или бизнес логи в базе данных, то в базу добавляются таблицы system_log и business_log соответственно. Структура базы различается в зависимости от приложения и места, где оно будет развёрнуто и под кем запущено, но вот возможный список полей.

| Поле          | Комментарий                                                                              |
|---------------|------------------------------------------------------------------------------------------|
| id            | идентификатор строки                                                                     |
| application   | Наименование приложение из которого поступил log                                         |
| machine_name  | наименование машины с которой поступил log                                               |
| logging_date  | дата составления записи                                                                  |
| error_level   | наименование уровня ошибки (trace, debug, info, warn, error, fatal)                      |
| message       | сообщение об ошибки                                                                      |
| logger        | кто вызвал                                                                               |
| call_site     | место вызова                                                                             |
| exception     | экземпляр exception                                                                      |
| user_name     | пользователь                                                                             |

6. Наименования:
1) Необходимо проверить, что придуманного имени нет в списке зарезервированных слов (список представлен в «Приложение 4. Зарезервированные слова SQL»).
2) Стараться ограничивать длину имени 30 байтами (30 символов).
3) Начинать имя нужно с буквы
4) Использовать в наименовании только буквы, цифры и подчёркивание.
5) Символ подчёркивания ставится там, где в реальной жизни стоял бы пробел (например, first name станет first_name).
6) Нужно стараться избегать сокращений или делать их понятными.

7. Таблицы:
1) Необходимо использовать собирательные имена или форму множественного числа (например, staff или employees).
2) Не допускать совпадение названий таблицы с названием столбцов.

8. Столбцы:
1) Название даются в ед. числе.

9. Зарезервированные ключевые слова пишутся прописными буквами:

| Плохо:        | Хорошо:       |
|---------------|---------------|
| Select, where | SELECT, WHERE |

10. Пробельные символы:
1) До и после знака равно (=)
2) После запятых (,)
3) До открывающего и после закрывающего апострофов ('), если последний не внутри скобок, или без последующих запятой или точки с запятой, или не в конце строки

11. Переводы строки:
1) Перед AND или OR
2) После точки с запятой (для разделения запросов)
3) После каждого основного ключевого слова
4) После запятой (при выделении столбцов)

